<html>
    <head>
        <title>YouTube Downloader</title>
        <link rel="icon" type="image/x-icon" href="/public/favicon.ico">
        <meta charset="UTF-8">
        <link rel ="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css">
        <link rel ="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.2/css/all.min.css">
        <link rel="stylesheet" href="css/yt.css">
    </head>

    <body> 
        <header>
            <ul>
                <li><a href="./" style="text-decoration: none;"><img class="logo" src="/logo2.png">Tubemate</a></li>
                <li><a href="/playlist">Play List</a></li>
                <li><a href="https://www.youtube.com/" target=”_blank”><img id="utube" src="youtube.png"></a></li>
                <li style="flex-grow: 1; border:none"> </li>
                <li><a href="">Copyrights</a></li>
            </ul>
        </header>

        <form class="container" onsubmit="route(event)">
            <img src="logo.png">
            <div class="a">
                <input id="in" type="text" placeholder="Youtube Link...">
                <select id="format">
                    <option value="1">Audio</option>
                    <option value="2">Video</option>
                </select>
            </div>
            
            <button id="btn" class="btn btn-info" type="submit" style="margin-top: 9px;">Generate</button>
        </form>
        
        <footer>
            <ul>
                <li>To download YouTube videos, follow these steps:</li><br>
                <li>1. Go to YouTube.com and find the video you want to download. Copy the video URL from the browser's address bar(eg. https://www.youtube.com/watch?v=aBKEt3MhNMM).</li>
                <li>2. Paste the video URL into search bar and select your desired download format (MP3 or MP4). If no format is chosen, the video will be converted to MP3 by default. Then, click the "Generate" button.</li>
                <li>3. The video conversion will begin, and it may take some time. Please note that only YouTube videos with a maximum length of 3 hours can be downloaded. Once the conversion is complete, you can download the converted video.</li>
                <li>By using this, you agree to our Terms of Use. We appreciate your use of our YouTube Converter.</li>
            </ul>
        </footer>
    </body>

    <script>
        function getVidId(url) {
            var regExp = /^.*((youtu.be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/;
            var match = url.match(regExp);
            if (match && match[7].length == 11) {
                return match[7];
            }else 
                return 'Invalid YouTube URL';
        }
        //https://www.youtube.com/watch?v=Dy4HA3vUv2c
        function route(event){
            event.preventDefault(); // Prevent the default form submission
   
            const link = document.getElementById("in").value;

            const vidId= getVidId(link);    

        //    const vidId = document.getElementById("in").value;
            const format = document.getElementById("format").value;
            if (format == 1){
                window.location.href = `/audio/${vidId}`;
            }
            if (format == 2){
                window.location.href = `/video/${vidId}`;
            } 
        }
        
    </script>


</html>